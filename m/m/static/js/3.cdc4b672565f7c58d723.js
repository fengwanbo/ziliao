webpackJsonp([3],{"3cXf":function(t,e,o){t.exports={default:o("L+o2"),__esModule:!0}},"L+o2":function(t,e,o){var s=o("ZuHZ"),r=s.JSON||(s.JSON={stringify:JSON.stringify});t.exports=function(t){return r.stringify.apply(r,arguments)}},VCkE:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=o("3cXf"),r=o.n(s);var i=function(t,e,o){var s=t.toString().split("."),r=e.toString().split(".");s[1]&&1==s[1].length&&(s[1]=s[1]+"0"),r[1]&&1==r[1].length&&(r[1]=r[1]+"0"),s[1]||s.push("00"),r[1]||r.push("00");var i=Number(s.join("")),n=Number(r.join("")),a="0";"add"==o?a=(i+n)/100:"sub"==o&&(a=(i-n)/100);var d=(a=a.toString()).split(".");return d[1]&&1==d[1].length&&(d[1]=d[1]+"0"),d[1]||d.push("00"),d.join(".")},n={components:{},data:function(){return{disabled:!1,goods_id:"",show:!1,btnLoading:!1,showOverlay:!0,district:"",order:{ru_id:"",shipping_type:"",consignee:"",mobile:"",address_name:"",shop_name:"",goods_name:"",goods_logo:"",goods_price:"0",goods_number:0,methods:"",time:"2月25号 13:00-16:00",message:"",total_pay:0},currentCoupon:{cou_title:"",uc_id:"",cou_money:"不使用优惠券"},fare:"该地暂不支持配送~",free_money:"0",shipping_name:"",shipping_free:"0",area_id_sprice:"0",shipping_code:"",shipping_id:"",hasTransport:!0,canShipping:!0,is_shipping:"0",cart_value:""}},created:function(){this.goods_id=this.$route.query.goods_id,this.order.goods_number=this.$route.query.cart_num,this.cart_value=this.$route.query.cart_value,sessionStorage.setItem("B2CWAP_ONEBUY_goods_id",r()({goods_id:this.goods_id})),this.getOrderInfo()},methods:{onClickLeft:function(){window.history.length>1?window.history.go(-1):window.location.href="/mobile/index.php"},toSelectArea:function(){var t="",e=this.$route.query;for(var o in e)t+="&"+o+"="+e[o];t="/mobile/index.php?m=flow&a=address_list"+t+"&from=vue_order",window.location.href=t},toSure:function(){var t=this;this.$api.order.done({ru_id:this.order.ru_id,ru_name:this.order.shop_name,shipping_type:this.order.shipping_type,shipping_code:this.shipping_code,shipping:this.shipping_id,postscript:this.order.message}).then(function(e){t.btnLoading=!1,e.data?t.$router.push({path:"/pay",query:{order_id:e.data.order_id,money:t.order.total_pay}}):t.$toast(e.msg)})},cartGoodsNumber:function(){var t=this;this.btnLoading=!0;setTimeout(function(){t.btnLoading=!1},6002);this.$api.order.cartGoodsNumber({id:this.cart_value,number:this.order.goods_number,arr:this.cart_value}).then(function(e){t.toSure()})},getOrderInfo:function(){var t=this;setTimeout(function(){t.showOverlay=!1},3001);this.$api.order.goods({goods_id:this.goods_id}).then(function(e){var o=e.data;if(o.consignee){if(t.order.consignee=o.consignee.consignee,t.order.mobile=o.consignee.mobile,t.order.address_name=o.consignee.region+" "+o.consignee.address,t.order.shop_name=o.goods.shop_name,t.order.goods_name=o.goods.goods_name,t.order.goods_price=o.goods.goods_price,t.order.goods_logo=o.goods.goods_logo,t.order.ru_id=o.goods.user_id,t.free_money=o.transport.transport&&o.transport.transport.free_money||0,t.order.shipping_type=o.transport.transport&&o.transport.transport.type||"",t.hasTransport=!!o.transport.transport,!o.transport.transport)return t.disabled=!0,void t.$toast("本商品暂不支持购买~");t.shipping_name=o.transport.express.shipping_name,t.shipping_free=o.transport.express.shipping_fee,t.shipping_code=o.transport.express.shipping_code,t.shipping_id=o.transport.express.shipping_id,t.district=o.consignee.district,t.shippingRange(o)}else t.toSelectArea()})},shippingRange:function(t){var e=this,o=t.consignee.city,s=t.consignee.district,r=t.transport.extend,i=t.range,n=new RegExp("\\b"+o+"\\b"),a=new RegExp("\\b"+s+"\\b"),d=r.find(function(t,o){return t.area_id.match(n)&&(e.area_id_sprice=t.sprice),t.area_id.match(n)}),c=i.find(function(t,e){return t.region_id.match(a)});if(!d||!c)return this.disabled=!0,this.canShipping=!1,void this.$toast("暂不支持该地配送~");1==t.goods.is_shipping?(this.is_shipping="1",this.fare="免运费",this.order.total_pay=Number(this.order.goods_price)*Number(this.order.goods_number),this.order.total_pay=this.order.total_pay.toFixed(2)):this.updataData()},updataData:function(){if(this.disabled)this.canShipping?this.$toast("本商品暂不支持购买~"):this.$toast("暂不支持该地配送~");else{var t=Number(this.order.goods_price)*Number(this.order.goods_number);t=t.toFixed(2)||0;var e=i(this.shipping_free||0,this.area_id_sprice||0,"add");this.hasTransport?"1"==this.is_shipping||this.canShipping&&Number(t)>=Number(this.free_money)?(this.fare="免运费",this.order.total_pay=t):(this.fare="￥"+e,this.order.total_pay=i(t,e,"add")):(this.fare="￥"+e,this.order.total_pay=i(t,e,"add"),this.$toast("本商品暂不支持购买~")),0==this.fare&&(this.fare="免运费")}},onChange:function(t){this.order.goods_number=t,this.updataData()},toSelectCoupon:function(t){if(this.show=!1,!t)return this.currentCoupon.cou_title="",this.currentCoupon.uc_id="",void(this.currentCoupon.cou_money="不使用优惠券");this.currentCoupon.cou_title=t.cou_title,this.currentCoupon.uc_id=t.uc_id;var e=this.order.goods_price*this.order.goods_number;if(t.cou_money>=e){var o=i(e,.01,"sub");this.currentCoupon.cou_money="-￥"+o,this.$toast("目前支付金额不能小于0.01元")}else this.currentCoupon.cou_money="-￥"+t.cou_money}}},a={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("van-nav-bar",{attrs:{title:"确认订单","left-text":"返回","left-arrow":""},on:{"click-left":t.onClickLeft}}),t._v(" "),o("div",{staticClass:"container"},[o("div",{staticClass:"area",on:{click:t.toSelectArea}},[t._m(0),t._v(" "),o("div",{staticClass:"area-center"},[o("h4",[t._v(t._s(t.order.consignee)+" "+t._s(t.order.mobile))]),t._v(" "),o("p",[t._v(t._s(t.order.address_name))])]),t._v(" "),o("div",{staticClass:"area-right"},[o("van-icon",{attrs:{name:"arrow",size:"16",color:"#c6c6c6"}})],1)]),t._v(" "),o("div",{staticClass:"goods"},[o("h4",[t._v(t._s(t.order.shop_name))]),t._v(" "),o("div",{staticClass:"goods-card",on:{click:t.onClickLeft}},[o("div",{staticClass:"goods-card-left"},[o("van-image",{attrs:{width:"70",height:"70",fit:"fill",radius:"5",src:t.order.goods_logo},scopedSlots:t._u([{key:"loading",fn:function(){return[o("van-loading",{attrs:{type:"spinner",size:"20"}})]},proxy:!0}])})],1),t._v(" "),o("div",{staticClass:"goods-card-right"},[o("div",{staticClass:"van-multi-ellipsis--l2"},[t._v(t._s(t.order.goods_name))]),t._v(" "),o("p",[t._v("￥"+t._s(t.order.goods_price))])])]),t._v(" "),o("van-cell",{staticClass:"custom-stepper",attrs:{title:"购买数量：",border:!1}},[o("template",{slot:"default"},[o("van-stepper",{attrs:{integer:"","button-size":"22px"},on:{change:t.onChange},model:{value:t.order.goods_number,callback:function(e){t.$set(t.order,"goods_number",e)},expression:"order.goods_number"}})],1)],2),t._v(" "),o("van-cell",{attrs:{border:!1},model:{value:t.fare,callback:function(e){t.fare=e},expression:"fare"}},[o("template",{slot:"title"},[o("span",{staticClass:"custom-title"},[t._v("配送方式：")]),t._v(" "),o("span",{staticClass:"custom-content"},[t._v(t._s(t.shipping_name))])])],2),t._v(" "),o("van-field",{attrs:{label:"备注：","label-width":"50px",type:"textarea",placeholder:"选填，请和商家协商一致",rows:"1",autosize:""},model:{value:t.order.message,callback:function(e){t.$set(t.order,"message",e)},expression:"order.message"}}),t._v(" "),o("van-cell",{attrs:{title:"",border:!1}},[o("template",{slot:"default"},[o("span",{staticClass:"custom-content"},[t._v("共1件商品")]),t._v(" "),o("span",{staticClass:"custom-title"},[t._v("合计：￥"+t._s(t.order.total_pay))])])],2)],1)]),t._v(" "),o("div",{staticClass:"btns"},[o("div",{staticClass:"btns-container"},[o("div",{staticClass:"btns-pay-price"},[t._v("￥"+t._s(t.order.total_pay))]),t._v(" "),o("van-button",{attrs:{color:"#ec5151",type:"primary",loading:t.btnLoading,disabled:t.disabled,"loading-text":"提交中..."},on:{click:t.cartGoodsNumber}},[t._v("提交订单")])],1)]),t._v(" "),o("van-overlay",{attrs:{show:t.showOverlay}},[o("div",{staticClass:"wrapper"},[o("van-loading",{attrs:{type:"spinner"}})],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"area-left"},[e("img",{attrs:{src:o("xnra"),alt:"定位"}})])}]};var d=o("C7Lr")(n,a,!1,function(t){o("jaYF")},"data-v-6ffa6e0c",null);e.default=d.exports},jaYF:function(t,e){},xnra:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAA2CAYAAAC8yXv8AAAExElEQVRogc2aX2hbVRzHP0kpLUsNaWvqfFgYgflQLJ1PotXpdD6oc4owkM0VXRGRPUxkir44BJ+m6EBRwT8Tpz5MUBFFp3Ui2g4f1HVlaonEmra2pHGNbW7i2uqVXz2Z2TV/zjm56faF0vT2/L7ncw/n3HN+v5vA8PAwdagV6AOuBy4HLgMuAdqUZQ5IA2PAKeALYAj407ZLW+DNwD3AnSVwupKbeBd4Xd2AkYKG7bcAcofHgH4LWFRMv/IYUp7a0gW+FDgCfAZcZQFZSVcrzyOqj5rSAb4RGAG2+wjq1XbVx031Aj8AHAWiDcE8V9LHx8Deao2qAT8MvAA0NRDSK+nroOq7rCoBy8geWEVQrw4ohv+pHPC1wHPnDfU/CcMm70UvcAfw5ipPg0oShsOK6ay8wM8AsQsAtihhebb0QulOdyVwXK5ZGCfC4fBgJBIZCoVCI83NzeNycWlpab3jOL3ZbLZvfn5eNogNFt6uevZ/4wX+ELjV0CwTiUQOxWKxw6FQaLRaQ8dxelKp1K5sNnsvcLFhPx8BW0uB5eBy0mR0A4HAiXg8/nRXV9dbJj2n0+mdyWRyn+u6Gw3CZJR7gdHiHB4wgQ0Gg6Pd3d37TWFFEiOx4mEQJmy7UYtOfu4yCHbi8fjBcDj8gSlsURIrHuJlECaMTQJ7BbBWN6qzs/ONaDT6mi1sUeIhXgYhwrgxqM62WgoEArOxWOztemGLEi/xNAjZLMDak7+9vX2wtbX1a2tCj8RLPA1CVkZY+9nY0dExVC9knZ4bBHidbuu2trYTdli+ea4LmqQ5LS0tCTss3zwvMgIOBoMZOyzfPNcI8Jxu6+XlZdMt1W/PrAAndVsXCgWbw4ufnkkB/kq39cLCgsn+3wjPbwX4E93WmUymz5LLL89PBfhL4LROa8dxtszNzV1jj3euxEs8NZvnisBnAN2zQTSVSu3wA1akvHRLCFLeyhWPl88Df+tE5fP5/vHx8d32mP9KPMTLIORlSnK6XwHdk1Noenr6wYmJiW0WnCuSWPEQL80QSY9WzjClSejjBmXQnsnJyScSicROU1iJkVjx0AyRbOOh4h9NAwMDxc/zatfTXVRr8/n8ppmZGZmDM+FwOF2t8dTUVM/Y2Ni+XC73GBDX7EP0Tmnm7K0Pr5G8ydBQlAgEAoOhUOhs1uy6LouLi+sLhUKv4zh9ruvaZM15oFtN2bLAqAriUct03289AjxV6lmuVCX12lcuANjvvEUUqhQDZQX/1HimiioAu+Rs5G1QCTivstQz54eXR4Efyv2jWn1YKuJ7GsdUUe9Xq57WqsC/Cry0Opwr+kUVTNxKDXTecexVb44aLSmq3F4rodABXgTuAH5uILCM6N1qD6gq3ddeUuy4Wf1uhParuVtTJi8WZYRvU08QPyUFxSd1/UzfhMqpaZuaJn7oWK1FVi+w6HP1jP6rTuBR9a7a6OZtgEXvAfeZjIxHE8AtwB+mgbbAokPqkWcK/RtwAzBp02k9wKgdaY8B9Kw6DVo/IusFFr0I3K8BfVrBlj0j6MoPYFSCOFBlIf6uvhcxUm9HfgGj5vSOMqt+Vn2F4Xs/OvETGPVFja2q6CGaAq7zY2SL8htYJBmLjKhU1iWh/dE3Z+AfvbldP2D1eIIAAAAASUVORK5CYII="}});